# 功能规格说明

## 1. 概述

楼宇资产管理平台是一个企业级的资产管理解决方案，通过四级资产层次结构（资产-楼宇-楼层-房间）实现精细化管理，并提供地图可视化、数据分析和完整的系统管理功能。

## 2. 功能模块详细说明

### 2.1 资产管理模块

#### 2.1.1 资产信息管理

**功能描述**：
- 支持资产的完整生命周期管理，从采购到报废的全过程跟踪
- 提供灵活的资产分类体系，支持自定义资产类型
- 实现四级层次结构的关联管理

**用户故事**：
1. 作为资产管理员，我需要录入新采购的资产信息，以便跟踪资产状态
2. 作为部门主管，我需要查看本部门的资产清单，以便了解资产分布
3. 作为财务人员，我需要导出资产报表，以便进行财务核算

**界面要求**：
- 资产列表页：支持分页、搜索、筛选、排序
- 资产详情页：展示完整资产信息，包括基本信息、使用历史、维修记录
- 资产编辑页：表单验证、图片上传、文档附件

**业务规则**：
1. 资产编号必须唯一，系统自动生成
2. 资产必须关联到具体的房间
3. 资产删除需要审批流程
4. 资产价值超过10万需要特殊标记

#### 2.1.2 楼宇管理

**功能描述**：
- 管理楼宇基本信息，包括位置、面积、产权等
- 支持楼宇平面图上传和查看
- 提供楼宇资产统计概览

**数据字段**：
```json
{
  "buildingCode": "B001",
  "buildingName": "科技大厦",
  "address": "北京市海淀区中关村大街1号",
  "totalArea": 50000,
  "floors": 20,
  "constructionDate": "2020-01-01",
  "propertyOwner": "XX科技有限公司",
  "managementUnit": "物业管理公司",
  "longitude": 116.3267,
  "latitude": 39.9804,
  "status": "在用",
  "images": ["url1", "url2"],
  "documents": ["doc1", "doc2"]
}
```

#### 2.1.3 楼层管理

**功能描述**：
- 管理楼层信息和平面布局
- 支持楼层平面图的上传和标注
- 提供楼层使用情况统计

**交互流程**：
1. 选择楼宇 → 查看楼层列表
2. 点击楼层 → 查看楼层详情和平面图
3. 编辑楼层 → 更新楼层信息
4. 上传平面图 → 标注房间位置

#### 2.1.4 房间管理

**功能描述**：
- 管理房间的基本信息和使用状态
- 关联房间内的资产清单
- 支持房间分配和调整

**状态管理**：
- 空闲：可以分配使用
- 在用：正常使用中
- 维修：暂时不可用
- 预留：已预定但未使用

### 2.2 地图展示模块

#### 2.2.1 地图可视化

**功能描述**：
- 基于天地图展示楼宇分布
- 支持多种地图图层切换
- 提供楼宇信息弹窗展示

**技术要求**：
- 使用天地图 JavaScript API 4.0
- 支持矢量图、卫星图、地形图切换
- 实现平滑的缩放和拖动
- 响应式适配不同屏幕

**交互设计**：
1. 地图初始化时自动定位到楼宇群中心
2. 鼠标悬停显示楼宇名称
3. 点击楼宇显示详细信息面板
4. 支持地图搜索和定位功能

#### 2.2.2 空间分析

**功能描述**：
- 区域框选统计功能
- 距离测量工具
- 路径规划功能

**使用场景**：
1. 框选某个区域，统计区域内的楼宇和资产数量
2. 测量两个楼宇之间的直线距离
3. 规划从A楼到B楼的最优路径

### 2.3 数据统计模块

#### 2.3.1 统计维度

**资产统计**：
- 按类型：IT设备、办公家具、车辆等
- 按状态：在用、闲置、维修、报废
- 按部门：各部门资产分布
- 按价值：资产价值区间分布
- 按时间：资产增长趋势

**空间统计**：
- 楼宇使用率
- 楼层占用情况
- 房间利用率
- 区域资产密度

#### 2.3.2 可视化图表

**图表类型**：
1. **柱状图**：资产类型分布、部门资产对比
2. **饼图**：资产状态占比、价值分布
3. **折线图**：资产增长趋势、折旧曲线
4. **热力图**：楼层资产密度、使用率分布
5. **仪表盘**：关键指标展示

**交互功能**：
- 图表联动筛选
- 数据钻取功能
- 导出图片和数据
- 自定义时间范围

### 2.4 系统管理模块

#### 2.4.1 用户管理

**功能清单**：
- 用户注册（需要管理员审批）
- 用户信息维护（基本信息、联系方式）
- 密码策略（复杂度要求、定期更换）
- 账号状态管理（启用、禁用、锁定）
- 批量导入用户（Excel模板）

**用户属性**：
```typescript
interface User {
  id: string;
  username: string;
  realName: string;
  email: string;
  phone: string;
  department: string;
  position: string;
  roles: Role[];
  status: 'active' | 'disabled' | 'locked';
  lastLoginTime: Date;
  createTime: Date;
}
```

#### 2.4.2 角色权限

**角色定义**：
1. **超级管理员**
   - 所有功能权限
   - 系统配置权限
   - 用户管理权限

2. **资产管理员**
   - 资产增删改查
   - 楼宇楼层房间管理
   - 资产报表查看

3. **部门主管**
   - 本部门资产查看
   - 资产申请审批
   - 部门报表查看

4. **普通用户**
   - 资产查看
   - 个人资产查询
   - 基础报表查看

**权限控制**：
- 功能权限：控制菜单和按钮显示
- 数据权限：控制数据访问范围
- 操作权限：控制增删改查操作

#### 2.4.3 审计日志

**日志类型**：
1. **登录日志**
   - 登录时间、IP地址、设备信息
   - 登录成功/失败状态
   - 异常登录告警

2. **操作日志**
   - 操作人、操作时间、操作类型
   - 操作对象、操作前后数据
   - 操作结果

3. **系统日志**
   - 系统错误日志
   - 性能监控日志
   - 安全事件日志

**日志管理**：
- 日志查询和筛选
- 日志导出功能
- 日志归档策略
- 日志保留期限设置

## 3. 非功能性规格

### 3.1 性能指标

| 指标 | 要求 | 测试方法 |
|------|------|----------|
| 页面加载时间 | < 3秒 | Chrome DevTools |
| API响应时间 | < 1秒 | JMeter压测 |
| 并发用户数 | > 1000 | 负载测试 |
| 数据库查询 | < 500ms | 慢查询日志 |
| 文件上传 | 10MB/s | 网络测试 |

### 3.2 可用性要求

- **系统可用性**：99.9%（全年停机时间不超过8.76小时）
- **备份策略**：每日增量备份，每周全量备份
- **恢复时间**：RTO < 4小时，RPO < 1小时
- **故障切换**：自动故障检测和切换

### 3.3 安全要求

- **认证方式**：JWT Token，有效期24小时
- **密码策略**：至少8位，包含大小写字母和数字
- **传输加密**：HTTPS/TLS 1.2+
- **数据加密**：敏感数据AES-256加密存储
- **访问控制**：基于RBAC的细粒度权限控制

### 3.4 兼容性要求

**浏览器支持**：
- Chrome 90+
- Firefox 88+
- Safari 14+
- Edge 90+

**屏幕适配**：
- 桌面：1920×1080, 1366×768
- 平板：1024×768, 768×1024
- 最小支持：1024×768

### 3.5 国际化支持

- 界面语言：简体中文（默认）
- 日期格式：YYYY-MM-DD
- 数字格式：千分位分隔符
- 货币显示：￥人民币

## 4. 接口规格

### 4.1 前后端接口规范

**RESTful API设计原则**：
- 使用HTTP动词表示操作
- URL表示资源
- 使用JSON格式传输数据
- 统一的错误处理格式

**API版本控制**：
- URL路径版本：/api/v1/
- 向后兼容原则
- 废弃API提前通知

### 4.2 第三方接口

**天地图API**：
- 版本：4.0
- 认证：API Key
- 限制：日调用量10万次
- 功能：地图展示、地理编码、路径规划

## 5. 数据规格

### 5.1 数据量预估

| 数据类型 | 预估数量 | 增长率 |
|----------|----------|--------|
| 用户 | 1,000 | 10%/年 |
| 楼宇 | 50 | 5%/年 |
| 楼层 | 1,000 | 5%/年 |
| 房间 | 10,000 | 5%/年 |
| 资产 | 100,000 | 20%/年 |
| 日志 | 1,000,000/月 | 30%/年 |

### 5.2 数据备份

- **备份频率**：每日凌晨2点自动备份
- **备份保留**：30天
- **备份存储**：本地+远程双备份
- **备份验证**：每周恢复测试

## 6. 部署规格

### 6.1 硬件要求

**生产环境**：
- CPU：8核心以上
- 内存：16GB以上
- 存储：500GB SSD
- 网络：千兆网卡

**开发环境**：
- CPU：4核心
- 内存：8GB
- 存储：100GB
- 网络：百兆网卡

### 6.2 软件要求

**操作系统**：
- CentOS 7.9 / Ubuntu 20.04 LTS
- Docker 20.10+
- Docker Compose 2.0+

**中间件**：
- Nginx 1.20+
- MySQL 5.7+
- Redis 5.0+

## 7. 测试规格

### 7.1 测试类型

1. **单元测试**：覆盖率 > 80%
2. **集成测试**：API接口测试
3. **功能测试**：用户场景测试
4. **性能测试**：负载和压力测试
5. **安全测试**：渗透测试

### 7.2 测试环境

- 独立的测试数据库
- 模拟生产环境配置
- 自动化测试工具集成
- 测试数据自动生成

## 8. 交付标准

### 8.1 交付物清单

1. **源代码**
   - 前端代码（React）
   - 后端代码（Go）
   - 数据库脚本
   - 配置文件

2. **文档**
   - 用户手册
   - 管理员手册
   - API文档
   - 部署文档

3. **其他**
   - 测试报告
   - 培训材料
   - 运维脚本

### 8.2 验收标准

- 所有功能测试通过
- 性能指标达标
- 安全漏洞修复
- 文档齐全准确
- 代码规范检查通过